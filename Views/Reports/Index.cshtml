@model star_events.Controllers.ReportsViewModel

@{
    ViewData["Title"] = "Reports Dashboard";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="page-header">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h1><i class="bi bi-graph-up me-3"></i>Reports Dashboard</h1>
            <p>Generate and view comprehensive reports for your events and business</p>
        </div>
        <div>
            <span class="badge bg-success fs-6">
                <i class="bi bi-shield-check me-1"></i>
                @(Model.IsAdmin ? "Administrator" : "Event Organizer")
            </span>
        </div>
    </div>
</div>

<!-- Quick Stats -->
<div class="row mb-4">
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="stats-card">
            <div class="d-flex align-items-center">
                <div class="stats-icon bg-primary">
                    <i class="bi bi-calendar-event"></i>
                </div>
                <div class="ms-3">
                    <p class="stats-number text-primary">@Model.TotalEvents</p>
                    <p class="stats-label">Total Events</p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="stats-card">
            <div class="d-flex align-items-center">
                <div class="stats-icon bg-success">
                    <i class="bi bi-ticket-perforated"></i>
                </div>
                <div class="ms-3">
                    <p class="stats-number text-success">@Model.TotalBookings</p>
                    <p class="stats-label">Total Bookings</p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="stats-card">
            <div class="d-flex align-items-center">
                <div class="stats-icon bg-warning">
                    <i class="bi bi-currency-dollar"></i>
                </div>
                <div class="ms-3">
                    <p class="stats-number text-warning">$@Model.TotalRevenue.ToString("N2")</p>
                    <p class="stats-label">Total Revenue</p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="stats-card">
            <div class="d-flex align-items-center">
                <div class="stats-icon bg-info">
                    <i class="bi bi-people"></i>
                </div>
                <div class="ms-3">
                    <p class="stats-number text-info">@Model.TotalUsers</p>
                    <p class="stats-label">Total Users</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Report Types -->
<div class="row mb-4">
    <div class="col-12">
        <div class="table-card">
            <div class="card-header">
                <h5><i class="bi bi-file-earmark-bar-graph me-2"></i>Available Reports</h5>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    @if (Model.IsAdmin)
                    {
                        <!-- Admin Reports -->
                        <div class="col-lg-4 col-md-6">
                            <div class="report-card h-100">
                                <div class="report-icon bg-primary">
                                    <i class="bi bi-currency-dollar"></i>
                                </div>
                                <div class="report-content">
                                    <h6>Overall Sales Reports</h6>
                                    <p class="text-muted">Track total income, payment methods, and financial performance
                                        across all events</p>
                                    <a asp-action="Revenue" class="btn btn-outline-primary btn-sm">
                                        <i class="bi bi-eye me-1"></i>View Report
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="report-card h-100">
                                <div class="report-icon bg-info">
                                    <i class="bi bi-people"></i>
                                </div>
                                <div class="report-content">
                                    <h6>Users Reports</h6>
                                    <p class="text-muted">Analyze user registrations, roles, and activity across the
                                        platform</p>
                                    <a asp-action="Users" class="btn btn-outline-info btn-sm">
                                        <i class="bi bi-eye me-1"></i>View Report
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="report-card h-100">
                                <div class="report-icon bg-success">
                                    <i class="bi bi-calendar-event"></i>
                                </div>
                                <div class="report-content">
                                    <h6>Events Reports</h6>
                                    <p class="text-muted">Analyze all events performance, attendance, and status across
                                        the platform</p>
                                    <a asp-action="Events" class="btn btn-outline-success btn-sm">
                                        <i class="bi bi-eye me-1"></i>View Report
                                    </a>
                                </div>
                            </div>
                        </div>
                    }
                    else if (Model.IsEventOrganizer)
                    {
                        <!-- Event Organizer Reports -->
                        <div class="col-lg-4 col-md-6">
                            <div class="report-card h-100">
                                <div class="report-icon bg-primary">
                                    <i class="bi bi-ticket-perforated"></i>
                                </div>
                                <div class="report-content">
                                    <h6>Ticket Sales Reports</h6>
                                    <p class="text-muted">Track ticket sales, scanning status, and attendance for your
                                        events</p>
                                    <a asp-action="TicketSales" class="btn btn-outline-primary btn-sm">
                                        <i class="bi bi-eye me-1"></i>View Report
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="report-card h-100">
                                <div class="report-icon bg-success">
                                    <i class="bi bi-currency-dollar"></i>
                                </div>
                                <div class="report-content">
                                    <h6>Revenue Reports</h6>
                                    <p class="text-muted">Track income, payment methods, and financial performance for
                                        your events</p>
                                    <a asp-action="Revenue" class="btn btn-outline-success btn-sm">
                                        <i class="bi bi-eye me-1"></i>View Report
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="report-card h-100">
                                <div class="report-icon bg-info">
                                    <i class="bi bi-calendar-event"></i>
                                </div>
                                <div class="report-content">
                                    <h6>Events Reports</h6>
                                    <p class="text-muted">Analyze your events performance, attendance, and status</p>
                                    <a asp-action="Events" class="btn btn-outline-info btn-sm">
                                        <i class="bi bi-eye me-1"></i>View Report
                                    </a>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Activity -->
<div class="row">
    <div class="col-xl-6">
        <div class="table-card">
            <div class="card-header">
                <h5><i class="bi bi-clock-history me-2"></i>Recent Bookings</h5>
            </div>
            <div class="card-body">
                @if (Model.RecentBookings.Any())
                {
                    <div class="activity-list">
                        @foreach (var booking in Model.RecentBookings.Take(5))
                        {
                            <div class="activity-item d-flex align-items-center mb-3">
                                <div
                                    class="activity-icon bg-success text-white rounded-circle d-flex align-items-center justify-content-center me-3">
                                    <i class="bi bi-ticket-perforated"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="fw-semibold">Booking #@booking.BookingID</div>
                                    <small
                                        class="text-muted">$@booking.TotalAmount.ToString("N2") • @booking.BookingDateTime.ToString("MMM dd, yyyy")</small>
                                </div>
                                <span
                                    class="badge @(booking.Status == "Completed" ? "bg-success" : booking.Status == "Pending" ? "bg-warning" : "bg-danger")">
                                    @booking.Status
                                </span>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <p class="text-muted text-center">No recent bookings found</p>
                }
            </div>
        </div>
    </div>
    <div class="col-xl-6">
        <div class="table-card">
            <div class="card-header">
                <h5><i class="bi bi-credit-card me-2"></i>Recent Payments</h5>
            </div>
            <div class="card-body">
                @if (Model.RecentPayments.Any())
                {
                    <div class="activity-list">
                        @foreach (var payment in Model.RecentPayments.Take(5))
                        {
                            <div class="activity-item d-flex align-items-center mb-3">
                                <div
                                    class="activity-icon bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3">
                                    <i class="bi bi-credit-card"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="fw-semibold">Payment #@payment.PaymentID</div>
                                    <small
                                        class="text-muted">$@payment.AmountPaid.ToString("N2") • @payment.PaymentMethod</small>
                                </div>
                                <span
                                    class="badge @(payment.PaymentStatus == "Completed" ? "bg-success" : payment.PaymentStatus == "Pending" ? "bg-warning" : "bg-danger")">
                                    @payment.PaymentStatus
                                </span>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <p class="text-muted text-center">No recent payments found</p>
                }
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Add report card styling
        const style = document.createElement('style');
        style.textContent = `
            .report-card {
                background: white;
                border-radius: 1rem;
                padding: 1.5rem;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                border: none;
                transition: transform 0.3s ease, box-shadow 0.3s ease;
                display: flex;
                flex-direction: column;
            }
            
            .report-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            }
            
            .report-icon {
                width: 60px;
                height: 60px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                color: white;
                margin-bottom: 1rem;
            }
            
            .report-content {
                flex-grow: 1;
                display: flex;
                flex-direction: column;
            }
            
            .report-content h6 {
                font-weight: 600;
                margin-bottom: 0.5rem;
            }
            
            .report-content p {
                flex-grow: 1;
                margin-bottom: 1rem;
            }
        `;
        document.head.appendChild(style);
    </script>
}
